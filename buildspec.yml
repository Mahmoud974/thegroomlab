version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 20
    commands:
    - echo "‚ö° Installation des d√©pendances..."
    - npm install

  build:
    commands:
    - echo "‚öôÔ∏è Build du projet Next.js..."
    - npm run build

  post_build:
    commands:
    - echo "üì§ D√©ploiement vers S3..."
    - aws s3 sync out/ s3://thegroomlab --delete
    - echo "‚ôªÔ∏è Invalidation CloudFront..."
    - aws cloudfront create-invalidation --distribution-id E1WL1KCM9ECW9J --paths "/*"

artifacts:
  files:
  - '**/*'
  base-directory: out
